#include <stdio.h>#include <stdlib.h>#include "getch.h"int print(int* maze,int length,int width);//打印地图并判定游戏是否结束void Move(int* x,int* y,int width,int* map); //参考4399小游戏,枚举了所有可能发生的事件,然后cv打法修修补补,//没想到有400行???一定是我太蔡了void swap(int* x,int* y); //糟粕的历史遗留产物,就懒得改了int main() {    char map[100];    int n = 1;    int x,y; //初始位置坐标    int i,j; //地图长宽    FILE* pScore=fopen("score.txt","r+");    for(n=1;n<=3;n++) {        int score = 0;                                  //初始化分数        sprintf(map, "map%d.txt", n);        FILE *fp = fopen(map, "r");        fscanf(fp, "%d%d%d%d", &x, &y, &i, &j);         //打开第n个地图文件        int Map[i][j];        for (int k = 0; k <= i * j - 1; k++) {            fscanf(fp, "%d", (int *) Map + k);        }                                               //读入地图        fclose(fp);        while (1) {            if (!print(Map, i, j)) break;            printf("第%d关当前得分是%d\n",n,score);//打印地图并判定游戏是否结束            Move(&x, &y, j, (int *) Map);            score++;                                    //加分辣        }        printf("恭喜你赢了第%d关,按任意键继续",n);        fprintf(pScore, "第%d关的分数是%d\n", n, score); //存分    }    fprintf(pScore,"----------------------------------------------------------------------------------------");    fclose(pScore);    printf("按任意键退出");    getch();    return 0;}int print(int* maze,int length,int width)  //打印地图{    system("clear");    int i,j;    int flag = 0;    printf("pushBoxes-sk\n英文输入法下使用wasd键操控♂,目的地为♀\n"           "人:♂踩在目的地上\n蘘:箱子归位\n越蔡得分越高,瞎按得分更高\n没有后悔药\n");    for(i=0;i<length;i++)    {        for(j=0;j<width;j++){            switch(*(maze+i*width+j)){                case 0: printf("■");break;     //墙                case 1: printf("  ");break;    //路                case 2: printf("♂");break;     //人                case 3: printf("箱");break;     //箱子                case 4: printf("♀");flag = 1;break;     //目的地                case 5: printf("人");flag = 1;break;     //人(在目的地上)                case 6: printf("蘘");break;     //            }        }        printf("\n");}    return flag;}void Move(int* x,int* y,int w,int* map)  //w:数组的宽度{    int Dire=(int)getch();    switch (Dire) {        case 119:            if(map[(*x)*w+*y]==2) {                switch (map[(*x - 1) * w + *y]) {                    case 1:                        swap(map + (*x) * w + *y, map + (*x - 1) * w + *y);                        (*x)--;                        break;                    case 3:                        switch (map[(*x - 2) * w + *y]) {                            case 1:                                map[*x * w + *y] = 1;                                map[(*x - 1) * w + *y] = 2;                                map[(*x - 2) *w+*y] = 3;                                (*x)--;                                break;                            case 4:                                map[*x * w + *y] = 1;                                map[(*x - 1) * w + *y] = 2;                                map[(*x - 2) *w+*y] = 6;                                (*x)--;                                break;                            default: break;                        }                        break;                    case 4:                        map[*x * w + *y] = 1;                        map[(*x - 1) * w + *y] = 5;                        (*x)--;                        break;                    case 6:                        switch (map[(*x - 2) * w + *y]) {                            case 1:                                map[*x * w + *y] = 1;                                map[(*x - 1) * w + *y] = 5;                                map[(*x - 2) *w+*y] = 3;                                (*x)--;                                break;                            case 4:                                map[*x * w + *y] = 1;                                map[(*x - 1) * w + *y] = 5;                                map[(*x - 2) *w+*y] = 6;                                (*x)--;                                break;                            default: break;                        }                        break;                    default: break;                }            }            else{                switch (map[(*x - 1) * w + *y]) {                    case 1:                        map[*x * w + *y] = 4;                        map[(*x - 1) * w + *y] = 2;                        (*x)--;                        break;                    case 3:                        switch (map[(*x - 2) * w + *y]) {                            case 1:                                map[*x * w + *y] = 4;                                map[(*x - 1) * w + *y] = 2;                                map[(*x - 2) *w+*y] = 3;                                (*x)--;                                break;                            case 4:                                map[*x * w + *y] = 4;                                map[(*x - 1) * w + *y] = 2;                                map[(*x - 2) *w+*y] = 6;                                (*x)--;                                break;                            default: break;                        }                        break;                    case 4:                        map[*x * w + *y] = 4;                        map[(*x - 1) * w + *y] = 5;                        (*x)--;                        break;                    case 6:                        switch (map[(*x - 2) * w + *y]) {                            case 1:                                map[*x * w + *y] = 4;                                map[(*x - 1) * w + *y] = 5;                                map[(*x - 2) *w+*y] = 3;                                (*x)--;                                break;                            case 4:                                map[*x * w + *y] = 4;                                map[(*x - 1) * w + *y] = 5;                                map[(*x - 2) *w+*y] = 6;                                (*x)--;                                break;                            default: break;                        }                        break;                }            }            break;        case 115:            if(map[(*x)*w+*y]==2) {                switch (map[(*x + 1) * w + *y]) {                    case 1:                        swap(map + (*x) * w + *y, map + (*x + 1) * w + *y);                        (*x)++;                        break;                    case 3:                        switch (map[(*x + 2) * w + *y]) {                            case 1:                                map[*x * w + *y] = 1;                                map[(*x + 1) * w + *y] = 2;                                map[(*x + 2) *w+*y] = 3;                                (*x)++;                                break;                            case 4:                                map[*x * w + *y] = 1;                                map[(*x + 1) * w + *y] = 2;                                map[(*x + 2) *w+*y] = 6;                                (*x)++;                                break;                            default: break;                        }                        break;                    case 4:                        map[*x * w + *y] = 1;                        map[(*x + 1) * w + *y] = 5;                        (*x)++;                        break;                    case 6:                        switch (map[(*x + 2) * w + *y]) {                            case 1:                                map[*x * w + *y] = 1;                                map[(*x + 1) * w + *y] = 5;                                map[(*x + 2) *w+*y] = 3;                                (*x)++;                                break;                            case 4:                                map[*x * w + *y] = 1;                                map[(*x + 1) * w + *y] = 5;                                map[(*x + 2) *w+*y] = 6;                                (*x)++;                                break;                            default: break;                        }                        break;                    default: break;                }            }            else{                switch (map[(*x + 1) * w + *y]) {                    case 1:                        map[*x * w + *y] = 4;                        map[(*x + 1) * w + *y] = 2;                        (*x)++;                        break;                    case 3:                        switch (map[(*x + 2) * w + *y]) {                            case 1:                                map[*x * w + *y] = 4;                                map[(*x + 1) * w + *y] = 2;                                map[(*x + 2) *w+*y] = 3;                                (*x)++;                                break;                            case 4:                                map[*x * w + *y] = 4;                                map[(*x + 1) * w + *y] = 2;                                map[(*x + 2) *w+*y] = 6;                                (*x)++;                                break;                            default: break;                        }                        break;                    case 4:                        map[*x * w + *y] = 4;                        map[(*x + 1) * w + *y] = 5;                        (*x)++;                        break;                    case 6:                        switch (map[(*x + 2) * w + *y]) {                            case 1:                                map[*x * w + *y] = 4;                                map[(*x + 1) * w + *y] = 5;                                map[(*x + 2) *w+*y] = 3;                                (*x)++;                                break;                            case 4:                                map[*x * w + *y] = 4;                                map[(*x + 1) * w + *y] = 5;                                map[(*x + 2) *w+*y] = 6;                                (*x)++;                                break;                            default: break;                        }                        break;                }            }            break;        case 100:            if(map[(*x)*w+*y]==2) {                switch (map[(*x) * w + *y+1]) {                    case 1:                        swap(map + (*x) * w + *y, map + (*x) * w + *y+1);                        (*y)++;                        break;                    case 3:                        switch (map[(*x) * w + *y+2]) {                            case 1:                                map[*x * w + *y] = 1;                                map[(*x ) * w + *y+1] = 2;                                map[(*x ) *w+*y+2] = 3;                                (*y)++;                                break;                            case 4:                                map[*x * w + *y] = 1;                                map[(*x) * w + *y+1] = 2;                                map[(*x) *w+*y+2] = 6;                                (*y)++;                                break;                            default: break;                        }                        break;                    case 4:                        map[*x * w + *y] = 1;                        map[(*x ) * w + *y+1] = 5;                        (*y)++;                        break;                    case 6:                        switch (map[(*x) * w + *y+2]) {                            case 1:                                map[*x * w + *y] = 1;                                map[(*x) * w + *y+1] = 5;                                map[(*x) *w+*y+2] = 3;                                (*y)++;                                break;                            case 4:                                map[*x * w + *y] = 1;                                map[(*x) * w + *y+1] = 5;                                map[(*x) *w+*y+2] = 6;                                (*y)++;                                break;                            default: break;                        }                        break;                    default: break;                }            }            else{                switch (map[(*x) * w + *y+1]) {                    case 1:                        map[*x * w + *y] = 4;                        map[(*x) * w + *y+1] = 2;                        (*y)++;                        break;                    case 3:                        switch (map[(*x ) * w + *y+2]) {                            case 1:                                map[*x * w + *y] = 4;                                map[(*x) * w + *y+1] = 2;                                map[(*x) *w+*y+2] = 3;                                (*y)++;                                break;                            case 4:                                map[*x * w + *y] = 4;                                map[(*x ) * w + *y+1] = 2;                                map[(*x) *w+*y+2] = 6;                                (*y)++;                                break;                            default: break;                        }                        break;                    case 4:                        map[*x * w + *y] = 4;                        map[(*x) * w + *y+1] = 5;                        (*y)++;                        break;                    case 6:                        switch (map[(*x) * w + *y+2]) {                            case 1:                                map[*x * w + *y] = 4;                                map[(*x ) * w + *y+1] = 5;                                map[(*x ) *w+*y+2] = 3;                                (*y)++;                                break;                            case 4:                                map[*x * w + *y] = 4;                                map[(*x) * w + *y+1] = 5;                                map[(*x) *w+*y+2] = 6;                                (*y)++;                                break;                            default: break;                        }                        break;                }            }            break;        case 97:            if(map[(*x)*w+*y]==2) {                switch (map[(*x) * w + *y-1]) {                    case 1:                        swap(map + (*x) * w + *y, map + (*x) * w + *y-1);                        (*y)--;                        break;                    case 3:                        switch (map[(*x) * w + *y-2]) {                            case 1:                                map[*x * w + *y] = 1;                                map[(*x ) * w + *y-1] = 2;                                map[(*x ) *w+*y -2] = 3;                                (*y)--;                                break;                            case 4:                                map[*x * w + *y] = 1;                                map[(*x) * w + *y-1] = 2;                                map[(*x) *w+*y-2] = 6;                                (*y)--;                                break;                            default: break;                        }                        break;                    case 4:                        map[*x * w + *y] = 1;                        map[(*x ) * w + *y-1] = 5;                        (*y)--;                        break;                    case 6:                        switch (map[(*x) * w + *y-2]) {                            case 1:                                map[*x * w + *y] = 1;                                map[(*x) * w + *y-1] = 5;                                map[(*x) *w+*y-2] = 3;                                (*y)--;                                break;                            case 4:                                map[*x * w + *y] = 1;                                map[(*x) * w + *y-1] = 5;                                map[(*x) *w+*y-2] = 6;                                (*y)--;                                break;                            default: break;                        }                        break;                    default: break;                }            }            else{                switch (map[(*x) * w + *y-1]) {                    case 1:                        map[*x * w + *y] = 4;                        map[(*x) * w + *y-1] = 2;                        (*y)--;                        break;                    case 3:                        switch (map[(*x ) * w + *y-2]) {                            case 1:                                map[*x * w + *y] = 4;                                map[(*x) * w + *y-1] = 2;                                map[(*x) *w+*y-2] = 3;                                (*y)--;                                break;                            case 4:                                map[*x * w + *y] = 4;                                map[(*x ) * w + *y-1] = 2;                                map[(*x) *w+*y-2] = 6;                                (*y)--;                                break;                            default: break;                        }                        break;                    case 4:                        map[*x * w + *y] = 4;                        map[(*x) * w + *y-1] = 5;                        (*y)--;                        break;                    case 6:                        switch (map[(*x) * w + *y-2]) {                            case 1:                                map[*x * w + *y] = 4;                                map[(*x ) * w + *y-1] = 5;                                map[(*x ) *w+*y-2] = 3;                                (*y)--;                                break;                            case 4:                                map[*x * w + *y] = 4;                                map[(*x) * w + *y-1] = 5;                                map[(*x) *w+*y-2] = 6;                                (*y)--;                                break;                            default: break;                        }                        break;                }            }            break;    }}void swap(int* x,int* y)   //{    int t=*x;    *x = *y;    *y = t;}